<div ng-controller="ProposalUpdateController as vm" data-ng-init="vm.init()">
	<div layout="column" ng-cloak class="md-inline-form">
		<div layout="row" layout-padding  class="cover client_cover">
			<div layout-align="left center" layout-padding flex>
				<h1 hide-xs>Atualizar Proposta</h1>
				<h3 hide-gt-sm hide-sm>Atualizar Proposta</h3>
			</div>
			<div layout-align="end" hide-xs>
				<md-button class="md-raised md-fab md-warn button_cover" aria-label="Novo Cliente" data-ui-sref="admin.propostas">
					<md-icon md-font-library="material-icons">arrow_back</md-icon>
				</md-button>
			</div>

			<div layout-align="end" hide-gt-sm hide-sm>
				<md-button class="md-raised md-fab md-mini md-warn button_cover" aria-label="Novo Cliente" data-ui-sref="admin.propostas">
					<md-icon md-font-library="material-icons md-24">arrow_back</md-icon>
				</md-button>
			</div>
		</div>
		<p ng-repeat="(name, errs) in vm.errors" class="alert alert-danger"><strong>Erro! </strong>: {{ errs.join(', ') }}</p>
		<form name="proposalForm" method="post" layout="row" layout-padding data-ng-submit="vm.updateProposal()" layout-align="center">
			<md-card flex="80">
				<md-input-container>
					<label>Nome do Projeto</label>
					<input ng-model="vm.proposal.title" name="title" type="text" data-md-minlength="10" data-md-maxlength="60" maxlength="60" required autofocus>
					<div ng-messages="proposalForm.title.$error" role="alert">
						<div ng-message="required" class="my-message">Título da proposta é obrigatório</div>
						<div ng-message="md-minlength" class="my-message">Título da proposta precisa ter no mínimo 10 caracteres</div>
						<div ng-message="md-maxlength" class="my-message">Título da proposta precisa ter no máximo 60 caracteres</div>
					</div>
				</md-input-container>
				<md-content layout-padding>
					<div layout-gt-sm="row" hide-xs>
						<lf-ng-md-file-input lf-files="vm.proposal.new_attachments"
							lf-placeholder="Adicione seus arquivos"
							lf-browse-label="Procurar" lf-remove-label="Remover"
							lf-drag-and-drop-label="Arraste os seus arquivos aqui..."
							multiple drag preview></lf-ng-md-file-input>
					</div>

					<div layout-gt-sm="row" hide-gt-sm hide-sm>
						<lf-ng-md-file-input lf-files="vm.proposal.new_attachments"
							lf-placeholder="Adicione seus arquivos"
							lf-browse-label="Procurar" lf-remove-label="Remover"
							multiple></lf-ng-md-file-input>
					</div>
				</md-content>
				<div class='md-padding' layout="row" layout-wrap layout-align="center">
					<md-card style="width: 300px;" ng-repeat="attachment in vm.proposal.attachments">
						<md-card-title>
							<h2>{{attachment.filename}}</h2>
						</md-card-title>
						<md-card-content>
							<p><strong>Tamanho do Arquivo: </strong>{{attachment.size}}</p>
							<p><strong>Checksum: </strong>{{attachment.checksum}}</p>
						</md-card-content>
						<md-card-actions layout="row" layout-align="end center">
							<md-button href="{{attachment.file}}" class="md-icon-button" aria-label="Baixar Arquivo" title="Baixar Arquivo">
								<md-icon>cloud_download</md-icon>
							</md-button>
							<md-button class="md-icon-button" aria-label="Remover" title="Remover">
								<md-icon>delete</md-icon>
							</md-button>
						</md-card-actions>
					</md-card>
				</div>
			</div>
		</div>
				<div layout="row" layout-align="center">
					<md-button class="md-raised md-primary" aria-label="Atualizar Proposta" type="submit" data-ng-disabled="proposalForm.$invalid">
						<md-icon>save</md-icon>
						<span hide-xs>Atualizar Proposta</span>
						<span hide-gt-sm hide-sm>Atualizar</span>
					</md-button>

					<md-button class="md-raised md-warn" aria-label="Enviar Proposta" data-ng-click="vm.sendProposal()" data-ng-disabled="proposalForm.$invalid">
						<md-icon>email</md-icon>
						<span hide-xs>Enviar Proposta</span>
						<span hide-gt-sm hide-sm>Enviar</span>
					</md-button>
				</div>
			</md-card>
		</form>
	</div>

</div>
